README for Small Footprint CIM Broker
=====================================

Additional Installation Info
----------------------------

In order to be functional sfcb will need a CIM schema installed. There's
a sample getSchema.sh script in /usr/[local/]share/sfcb that will retrieve
CIM Schema V2.9.0 from the DMTF homepage and copy the MOF files to
/usr/[local/]share/sfcb/CIM .

Registration
------------

The package has two helper scripts that can be used to register providers
with sfcb in a two step process:

1. Staging

A provider must be acompanied by an sfcb registration file describing it
and by (a set of) MOF(s) for the class definition. With the sfcbstage
command these are copied into the staging area in 
[/usr/local]/var/lib/sfcb/stage. This step doesn't modify the repository.

Usage example:

sfcbstage -r provider.reg class1.mof class2.mof

2. Repository Rebuild

With the sfcbrepos command the entire repository and provider registration
for sfcb is rebuilt. In order to work it requires a CIM schema MOF collection
in /usr/[local/]share/sfcb/CIM and data in the staging area mentioned above.
When invoked without the -f option, it will issue a warning that all previous 
data will be lost. As long as you really plan to rebuild the repository this
is OK.
Obviously it is desirable to stop sfcb before the rebuild is performed.

CVS Instructions
----------------

If you have extracted the package from CVS you should do two things to enable
the build environment (including the MOF compiler):

1. Check out the mofc package into the sfcb directory. Should be as easy
   as cvs co mofc . If you don't need mofc you can skip this step.

2. Run autoconfiscate.sh to setup for build.

NOTE: The autoconfiscating requires automake, autoconf and libtool installed
on your build system. IMPORTANT: libtool 1.5.8 or higher is required. As of
the date of this writing (March 2005) this version was not yet shipped with
the usual distributions. Please make sure, you have the right version of
libtool installed!

Step by Step Instructions
-------------------------

This is a description of the minimum number of steps to get sfcb up and
running:

If you have received as tarball, invoke
  tar xvjd sfcb-<version>.tar.bz2 

If you want to check out from CVS, invoke (with CVSROOT set correctly)
  cvs co sfcb
  cd sfcb
  cvs co mofc
  ./autoconfiscate.sh

In both cases continue with
  ./configure
  make
  make install (need superuser rights)
  make install-cimschema (superuser, need access to internet)

Make sure that /usr/local/bin is in the path and /usr/local/lib either in 
LD_LIBRARY_PATH or /etc/ld.so.conf and invoke
  sfcbrepos -f (superuser, ignore error message)

Start the sfcb by either invoking sfcbd or /usr/local/etc/init.d/sfcb start

Execute a CIM client request, i.e. with SBLIM wbemcli:
  wbemcli -dx ec http://localhost/root/cimv2
you should see an output similar to:


To server: <?xml version="1.0" encoding="utf-8" ?>
<CIM CIMVERSION="2.0" DTDVERSION="2.0">
<MESSAGE ID="4711" PROTOCOLVERSION="1.0"><SIMPLEREQ><IMETHODCALL NAME="EnumerateClasses"><LOCALNAMESPACEPATH><NAMESPACE NAME="root"></NAMESPACE><NAMESPACE NAME="cimv2"></NAMESPACE></LOCALNAMESPACEPATH>
<IPARAMVALUE NAME="ClassName"><CLASSNAME NAME=""/></IPARAMVALUE>
<IPARAMVALUE NAME="DeepInheritance"><VALUE>TRUE</VALUE></IPARAMVALUE>
<IPARAMVALUE NAME="LocalOnly"><VALUE>FALSE</VALUE></IPARAMVALUE>
<IPARAMVALUE NAME="IncludeQualifiers"><VALUE>FALSE</VALUE></IPARAMVALUE>
<IPARAMVALUE NAME="IncludeClassOrigin"><VALUE>TRUE</VALUE></IPARAMVALUE>
</IMETHODCALL></SIMPLEREQ>
</MESSAGE></CIM>
From server: <?xml version="1.0" encoding="utf-8" ?>
<CIM CIMVERSION="2.0" DTDVERSION="1.1">
<MESSAGE ID="4711" PROTOCOLVERSION="1.0">
<SIMPLERSP>
<IMETHODRESPONSE NAME="EnumerateClasses">
<IRETURNVALUE>
</IRETURNVALUE>
</IMETHODRESPONSE>
</SIMPLERSP>
</MESSAGE>
</CIM>
